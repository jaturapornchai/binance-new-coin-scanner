package main

import (
	"encoding/json"
	"fmt"
	"log"
)

func main() {
	fmt.Println("ЁЯЪА р╕Хр╕▒р╕зр╕кр╣Бр╕Бр╕Щр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И Binance")
	fmt.Println("ЁЯЖХ р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И (тЙд30 р╕зр╕▒р╕Щ)")
	fmt.Println("ЁЯОп р╣Вр╕нр╕Бр╕▓р╕кр╣Ар╕Вр╣Йр╕▓р╕Бр╣Ир╕нр╕Щр╣Гр╕Др╕г + AI р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Бр╕▓р╕гр╕кр╕░р╕кр╕б")
	fmt.Println("===============================================")

	// Scan for best coins
	fmt.Println("ЁЯФН р╕Бр╕│р╕ер╕▒р╕Зр╕Др╣Йр╕Щр╕лр╕▓р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Бр╣Ир╕нр╕Щр╣Гр╕Др╕г...")
	bestCoins, err := scanBestCoins()
	if err != nil {
		log.Fatalf("тЭМ р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Бр╕Бр╕Щр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Др╕Фр╣Й: %v", err)
	}

	// Show results
	fmt.Printf("\nтЬЕ р╕Юр╕Ър╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╕Щр╣Ир╕▓р╕кр╕Щр╣Гр╕И %d р╣Ар╕лр╕гр╕╡р╕вр╕Н\n\n", len(bestCoins))

	if len(bestCoins) == 0 {
		fmt.Println("тЭМ р╣Др╕бр╣Ир╕Юр╕Ър╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╕Хр╕гр╕Зр╕Хр╕▓р╕бр╣Ар╕Бр╕Ур╕Ср╣М")
		fmt.Println("ЁЯФЪ р╕Бр╕▓р╕гр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ!")
		return
	}

	fmt.Println("ЁЯПЖ р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╕вр╕нр╕Фр╕Щр╕┤р╕вр╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Бр╣Ир╕нр╕Щр╣Гр╕Др╕г:")
	fmt.Println("р╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ | р╕кр╕▒р╕Нр╕ер╕▒р╕Бр╕йр╕Ур╣М     | р╕гр╕▓р╕Др╕▓       | р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ  | р╕Ыр╕гр╕┤р╕бр╕▓р╕У    | р╕Др╕░р╣Бр╕Щр╕Щ | р╕зр╕▒р╕Щ  | р╕ир╕▒р╕Бр╕вр╕ар╕▓р╕Юр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И")
	fmt.Println("-------|---------------|------------|---------|-----------|-------|------|------------------")

	for i, coin := range bestCoins {
		fmt.Printf("%-7d | %-13s | $%-9.8f | %+6.1f%% | $%-8.0fK | %5.1f | %-4d | %s\n",
			i+1,
			coin.Symbol,
			coin.Price,
			coin.PriceChange,
			coin.Volume24h/1000,
			coin.Score,
			coin.AgeDays,
			coin.Reason)
	}

	// AI Analysis for Accumulation
	fmt.Printf("\nЁЯдЦ AI р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Бр╕▓р╕гр╕кр╕░р╕кр╕бр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И...\n")
	aiAnalyses, err := analyzeCoinsForAccumulation(bestCoins)
	if err != nil {
		fmt.Printf("тЪая╕П AI analysis р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з: %v\n", err)
	} else {
		// Convert to JSON
		jsonData, err := json.MarshalIndent(aiAnalyses, "", "  ")
		if err != nil {
			fmt.Printf("тЪая╕П р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щ JSON: %v\n", err)
		} else {
			fmt.Printf("\nЁЯУК AI Analysis Results (JSON):\n")
			fmt.Println(string(jsonData))
		}

		// Show summary
		fmt.Printf("\nЁЯУЛ р╕кр╕гр╕╕р╕Ы AI Analysis:\n")
		shouldAccumulate := 0
		reverseSignals := 0
		for _, analysis := range aiAnalyses {
			if analysis.ShouldAccumulate {
				shouldAccumulate++
			}
			if analysis.ReverseSignal {
				reverseSignals++
			}
		}

		fmt.Printf("   тАв р╣Ар╕лр╕гр╕╡р╕вр╕Нр╕Чр╕╡р╣Ир╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣М: %d р╣Ар╕лр╕гр╕╡р╕вр╕Н\n", len(aiAnalyses))
		fmt.Printf("   тАв р╣Бр╕Щр╕░р╕Щр╕│р╣Гр╕лр╣Йр╕кр╕░р╕кр╕б: %d р╣Ар╕лр╕гр╕╡р╕вр╕Н\n", shouldAccumulate)
		fmt.Printf("   тАв р╕бр╕╡р╕кр╕▒р╕Нр╕Нр╕▓р╕Ур╕Бр╕ер╕▒р╕Ър╕Хр╕▒р╕з: %d р╣Ар╕лр╕гр╕╡р╕вр╕Н\n", reverseSignals)

		// Show top recommendations
		fmt.Printf("\nЁЯОп р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Бр╕Щр╕░р╕Щр╕│р╕Ир╕▓р╕Б AI:\n")
		for _, analysis := range aiAnalyses {
			if analysis.ShouldAccumulate || analysis.ReverseSignal {
				fmt.Printf("   тАв %s: %s (р╕Др╕зр╕▓р╕бр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕▒р╣Ир╕Щ: %s, р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З: %s)\n",
					analysis.Symbol,
					analysis.RecommendedAction,
					analysis.Confidence,
					analysis.RiskLevel)
				if analysis.ReverseSignal {
					fmt.Printf("     тЪб р╕бр╕╡р╕кр╕▒р╕Нр╕Нр╕▓р╕Ур╕Бр╕ер╕▒р╕Ър╕Хр╕▒р╕зр╕Вр╕╢р╣Йр╕Щ!\n")
				}
			}
		}
	}

	// Enhanced Summary for NEW Coin Analysis
	fmt.Printf("\nЁЯУК р╕кр╕гр╕╕р╕Ыр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И:\n")
	fmt.Printf("   тАв р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в: р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И (тЙд30 р╕зр╕▒р╕Щ)\n")
	fmt.Printf("   тАв р╕Ир╕│р╕Щр╕зр╕Щр╕кр╕▒р╕Нр╕ер╕▒р╕Бр╕йр╕Ур╣Мр╕Чр╕╡р╣Ир╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣М: ~3,000+\n")
	fmt.Printf("   тАв р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╕Ьр╣Ир╕▓р╕Щр╣Ар╕Бр╕Ур╕Ср╣М: %d р╣Ар╕лр╕гр╕╡р╕вр╕Н\n", len(bestCoins))
	fmt.Printf("   тАв р╕Др╕░р╣Бр╕Щр╕Щр╕кр╕╣р╕Зр╕кр╕╕р╕Ф: %.1f\n", bestCoins[0].Score)
	fmt.Printf("   тАв р╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣Ир╕вр╕нр╕Фр╕Щр╕┤р╕вр╕б: %s\n", bestCoins[0].Symbol)

	fmt.Printf("\nЁЯТб р╣Ар╕Бр╕Ур╕Ср╣Мр╕Бр╕▓р╕гр╕Др╕▒р╕Фр╣Ар╕ер╕╖р╕нр╕Бр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И:\n")
	fmt.Printf("   тАв р╕Ыр╕гр╕┤р╕бр╕▓р╕Ур╕Вр╕▒р╣Йр╕Щр╕Хр╣Ир╕│: 50K+ USDT р╕Хр╣Ир╕нр╕зр╕▒р╕Щ\n")
	fmt.Printf("   тАв р╕Кр╣Ир╕зр╕Зр╕гр╕▓р╕Др╕▓: $0.000001 - $2 (р╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕│)\n")
	fmt.Printf("   тАв р╕Кр╣Ир╕зр╕Зр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З: -90%% р╕Цр╕╢р╕З +1000%% (р╕Др╕зр╕▓р╕бр╕Ьр╕▒р╕Щр╕Ьр╕зр╕Щр╕кр╕╣р╕З)\n")
	fmt.Printf("   тАв р╣Вр╕Яр╕Бр╕▒р╕к: р╣Ар╕лр╕гр╕╡р╕вр╕Нр╕Чр╕╡р╣Ир╣Ар╕Вр╣Йр╕▓р╣Гр╕лр╕бр╣И (р╣Др╕бр╣Ир╕гр╕зр╕бр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕Нр╣Ир╣Ар╕Бр╣Ир╕▓)\n")
	fmt.Printf("   тАв р╕Др╕░р╣Бр╕Щр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╣Ир╕│: 20+ р╕Др╕░р╣Бр╕Щр╕Щ\n")

	fmt.Printf("\nЁЯОп р╣Бр╕Щр╕░р╕Щр╕│р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Бр╣Ир╕нр╕Щр╣Гр╕Др╕г:\n")
	fmt.Printf("   р╕кр╕▒р╕Нр╕ер╕▒р╕Бр╕йр╕Ур╣Мр╕лр╕ер╕▒р╕Б: %s\n", bestCoins[0].Symbol)
	fmt.Printf("   р╕гр╕▓р╕Др╕▓р╣Ар╕Вр╣Йр╕▓: $%.8f\n", bestCoins[0].Price)
	fmt.Printf("   р╕Бр╕ер╕вр╕╕р╕Чр╕Шр╣М: %s\n", bestCoins[0].Reason)
	fmt.Printf("   р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓: р╕Кр╣Ир╕зр╕Зр╕Бр╕▓р╕гр╕кр╕░р╕кр╕бр╕Бр╣Ир╕нр╕Щр╣Гр╕Др╕г\n")

	fmt.Println("\nЁЯФЪ р╕Бр╕▓р╕гр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Ар╕лр╕гр╕╡р╕вр╕Нр╣Гр╕лр╕бр╣И + AI Analysis р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ!")
}
